### 共识机制

  &emsp;&emsp;所谓“共识机制”，是通过特殊节点的投票，在很短的时间内完成对交易的验证和确认；对一笔交易，如果利益不相干的若干个节点能够达成共识，
我们就可以认为全网对此也能够达成共识。再通俗一点来讲，如果中国一名微博大V、美国一名虚拟币玩家、一名非洲留学生和一名欧洲旅行者互不相识，
但他们都一致认为你是个好人，那么基本上就可以断定你这人还不坏。

### PBFT算法
#### 三个阶段：预准备（pre-prepare）、准备（prepare）、和确认（commit）

![CSDN图标](https://upload-images.jianshu.io/upload_images/2657976-a03ec11d1cf3c941.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700
 "这是CSDN的图标")
步骤：

##### 从全网节点选举出一个主节点（Leader），新区块由主节点负责生成
* Pre-Prepare：每个节点把客户端发来的交易向全网广播，主节点0将从网络收集到需放在新区块内的多个交易排序后存入列表，并将该列表向全网广播，扩散至123
* Prepare：每个节点接收到交易列表后，根据排序模拟执行这些交易。所有交易执行完后，基于交易结果计算新区块的哈希摘要，并向全网广播，1->023，2->013，3因为宕机无法广播
* Commit：如果一个节点收到的2f（f为可容忍的拜占庭节点数）个其它节点发来的摘要都和自己相等，就向全网广播一条commit消息
* Reply：如果一个节点收到2f+1条commit消息，即可提交新区块及其交易到本地的区块链和状态数据库。



#### 拜占庭将军问题
  &emsp;&emsp;拜占庭帝国，拥有巨大的财富，周围10个邻邦垂诞已久，但拜占庭高墙耸立，没有一个单独的邻邦能够成功入侵。任何单个邻邦入侵的都会失败，
同时也有可能自身被其他9个邻邦入侵。拜占庭帝国防御能力如此之强，至少要有十个邻邦中的一半以上同时进攻，才有行。


### 工作量证明（Proof Of Work）
  &emsp;&emsp;假如10个将军都发信息，很容易乱，因为每个人都收到另外9个人的信息，所以中本聪规定只有一个人可以发出发起进攻的信息，这个人是谁都可以，但是有一定的条件限制，
这个条件就是“工作量”，就是说这个人必须完成一个计算工作才能发消息，谁先完成这个计算工作，谁就能发消息。
当某个将军计算出这个结果后就发出进攻的消息，其它将军看到后必须签名表示自己的身份，这里请注意，
古代那个签名是很容易伪造的，所以中本聪引入了加密技术，就是非对称加密，它的好处：1.消息的私秘性。2.确认签名人身份。3.签名不可伪造不可篡改。

#### 非对称加密
  &emsp;&emsp;非对称加密算法是由非对称加密算法的加密和解密使用不同的两个密钥.这两个密钥就是公钥和私钥.
公钥和私钥一般成对出现, 如果消息使用公钥加密,那么需要该公钥对应的私钥才能解密; 同样，如果消息使用私钥加密,那么需要该私钥对应的公钥才能解密.
非对称加密的作用是:保护消息内容, 并且让消息接收方确定发送方的身份

### 总结
  &emsp;&emsp;1.共识算法主要是解决由谁来创建区块，如何维护区块链的统一性。</br>
 &emsp;&emsp;2.在本文中工作量证明解决了一致性问题，非对称加密技术解决了信任问题。</br>
 &emsp;&emsp;3.PBFT不需要非对称加密算法，节点间不对等，可能导致处理速度快。
