DID（数字身份）技术设计指南
基于UTXO的区块链数字身份概要设计，目的是用比特币的安全标准定义数字身份。众所周知，区块链技术上比特币的安全标准是长期经过了实践检验的，安全性可能是最高的，而数字身份除了去中心化的需求外，最重要的三个要素是：安全，安全，安全！
因而我认为数字身份理当用传统的比特币算法来实现，基于此特地把这段时间的心得总结如下：
1.设计原则：
did与主私钥绑定，与地址一对一绑定，因而did的只能从同一个账号的地址之间进行转移。
did 标识符目前支持大小写和@以及.符号组合，最长64个字节。
did双花问题，避免did更改地址后的交易中使用废弃的地址，主要靠矿工对最新did与地址之间的映射进行校检，如果使用did旧地址进行did类型的交易将无法入块。
did与所有类型的交易兼容，可共存，即任何一笔交易无论是发布资产或者转移etp或者一条message交易，都可以加上did标签。
did校检与did应用分开设计，did验证主要用C++去实现，did应用用脚本实现。

2.did交易：
发布一条did类型的交易很简单，做三件事：将attachement的version设置为207（程序中的一个宏），设置fromdid或todid参数（可共存），用fromdid对应的地址出手续费或用todid对应的地址当目的地址（可共存）。
所有的

3.did与did的关系：
did与did之间的关系，即地址之间的关系，对于hd钱包，通常他们不存在任何关系，除非发生了交易，如果未来有did之间限定关系的需求，建议采用共同签名交易的方式来实现。

4.did校检：
did校检即检查一个output是否来自一个did,或者一个output是否去向一个did。来自一个did的校检属于弱校检，即只要在这个交易中fromdid对应的地址出了手续费（或者进行了别的花费）。去向一个did的校检属于强校检，这个output对应的地址必须是todid绑定的地址。


5.did应用：
did的校检与did应用是分开的，did的功能主要靠did profile来实现，目前最重要的两个应用是验证和授权
did对应一个地址，did profile对应一个output。因而did与profile的所有关系，仅限于交易中的地址与output之间的关系。
did profile包含一个profile脚本，它负责限定“花”这个profile必须的条件，以及满足条件后处分仅限于该output中的资源（如etp,资产以及profile）的动作。
did与did profile之间的关系主要分两种，did可以发布did profile，did可以拥有did profile。did验证即判断一个did是否拥有一个did profile，did授权则意味着一个did将一个did profile （全部或一部分）转移到了另一个did身上。
did发布一个did profile时，可以限定为发布给自身did上，这样就意味着任何满足了该did profile脚本限定条件的人，都可以执行did prodile里面的处置脚本。如果发布给其他的did则表示只有该用户才可以执行处置脚本，同时它必须满足did profile脚本限定条件。这样设计即满足了需求，又保证了用户不能自己给自己授权验证。
did profile之间的转移可以是全部的也可以是部分，最初发布的did profile可以先后将同一个did profile授权给多个用户。如果全部转移给了另一个用户，则意味着该用户拥有了这个did profile的所有权，它可以二次授权给其他人。如果是部分授权它就没有二次授权的权利。部分授权时该did必须有一个对应的未被花费的did profile。
did profile与did profile本身没有关系，每个did profile有一个symbol，按照”did-symbol”的格式入区块链，即每个did发布的did profile名字必须是不同的，但是不同的did可以发布同一个名字的did profile。did profile所有权发生转移时，名字的前缀也会发生改变。
did profile的脚本为wren语言编写，它有两部分，限定条件脚本和处置脚本。限定条件脚本会在花费的时候被所有的节点执行进行验证，处置脚本则只会在条件满足情况下被特定did执行。逻辑为：if(限定条件脚本) then (处置脚本)



6.wren脚本：
wren(http://wren.io)是一种小型的、快速的、基于类别的编程语言。之所以选择Wren语言和虚拟机，是因为它的短小精悍、易于文档记录和理解的代码库。它还具有非常好的性能，并且可以很容易地嵌入C++应用程序中。


